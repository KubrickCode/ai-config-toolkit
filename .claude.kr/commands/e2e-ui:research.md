---
description: UI E2E 테스트 대상 리서치 및 테스트 시나리오 문서 생성
---

# UI E2E 테스트 리서치 커맨드

## 필수 전제 조건

- ✅ 프론트엔드 서버가 이미 실행 중이어야 함
- ✅ Playwright MCP 서버가 실행 중이어야 함

## 사용자 입력

```text
$ARGUMENTS
```

사용자 입력에서 포트 번호를 추출하고 추가 컨텍스트가 있으면 고려합니다 (비어있지 않은 경우).

---

## 개요

이 커맨드는 **Playwright MCP를 통한 실제 브라우저 탐색**을 포함한 종합적인 UI E2E 테스트 리서치를 수행합니다.

### 핵심 특징

- 🎭 **실제 브라우저 탐색**: Playwright MCP로 애플리케이션 직접 조작
- 📊 **코드베이스 분석**: 정적 분석으로 라우트 및 컴포넌트 파악
- 🔄 **이중 언어 문서**: 한국어/영어 버전 동시 생성
- 🧠 **비즈니스 도메인 파악**: 백엔드 분석으로 도메인 컨텍스트 이해
- 📝 **항상 새로 생성**: 기존 문서는 삭제하고 완전히 새로운 문서 생성

---

## 실행 단계

### 1. 사전 준비 및 컨텍스트 수집

#### 프로젝트 타입 감지

**package.json 분석**:

- `"next"` → Next.js 프로젝트
- `"react"` + `"react-router"` → React SPA

**파일 구조 분석**:

- `app/` 디렉토리 → Next.js App Router
- `pages/` 디렉토리 → Next.js Pages Router 또는 React

#### 적절한 Skills 자동 로드

감지된 프레임워크에 따라:

- Next.js → `.claude/skills/nextjs` (있는 경우)
- React → `.claude/skills/react` (있는 경우)
- 항상 `.claude/skills/typescript` 및 `.claude/skills/typescript-test` 로드 (있는 경우)

#### 백엔드 비즈니스 도메인 파악 (해당되는 경우)

**백엔드 존재 여부 감지**:

- `backend/`, `server/`, `api/` 디렉토리 존재
- package.json에 서버 프레임워크 (Express, Fastify, NestJS 등)
- docker-compose.yml에 백엔드 서비스

**프로젝트 분석**:

- `README.md`: 프로젝트 개요, 아키텍처
- `CLAUDE.md`: 도메인 지식, 비즈니스 규칙
- 백엔드가 있는 경우 REST API 혹은 GraphQL API 엔드포인트
- 백엔드가 있는 경우 데이터 모델 확인
- OpenAPI/Swagger 문서 (있는 경우)

**파악해야 할 정보**:

- 주요 도메인 엔티티 (User, Product, Order 등)
- 핵심 비즈니스 플로우 (주문, 결제, 인증 등)
- 권한 모델 (RBAC, ABAC)
- 외부 서비스 연동

### 2. 기존 UI E2E 테스트 파일 분석 (컨텍스트 파악용)

- Glob으로 테스트 파일 검색 (`**/*.e2e.{ts,tsx,js,jsx}`, `**/*.spec.{ts,tsx,js,jsx}`, `tests/e2e-ui/**/*`, `e2e/**/*`)
- 기존 테스트 **케이스 설명(describe/test)만** 읽어서 커버리지 이해
- 테스트 패턴 및 구조 파악
- **중요**: 기존 문서(`docs/e2e-ui/test-targets.md`)는 **읽지 않음** (삭제 후 새로 생성)

### 3. 코드베이스 정적 분석

**프론트엔드 구조 분석**:

- Glob으로 라우트 정의 찾기
  - Next.js: `app/**/page.{ts,tsx}`, `pages/**/*.{ts,tsx}`
  - React Router: `src/routes/**/*.{ts,tsx}`, `src/pages/**/*.{ts,tsx}`
  - SvelteKit: `src/routes/**/+page.svelte`
- 주요 페이지 컴포넌트 읽기
- 사용자 플로우 및 상호작용 매핑
- 주요 UI 컴포넌트 및 기능 목록화

### 4. 🎭 Playwright MCP 실제 브라우저 탐색 (필수)

**이 단계가 가장 중요합니다!** 코드 분석만으로는 실제 사용자 경험을 알 수 없습니다.

#### 4.1 초기 접속 및 기본 구조 파악

```javascript
// MCP 도구 사용 예시
browser_navigate: http://localhost:{port}
browser_snapshot: 초기 페이지 DOM 구조 캡처
```

- 메인 페이지 구조 분석
- 네비게이션 메뉴 요소 식별
- 주요 링크 및 버튼 목록화

#### 4.2 주요 페이지 순회

코드에서 파악한 라우트 목록을 기반으로:

```javascript
// 각 페이지마다
browser_navigate: http://localhost:{port}/{route}
browser_snapshot: 페이지 DOM 구조 캡처
```

- 각 페이지의 상호작용 가능한 요소 식별 (버튼, 링크, 폼, 드롭다운)
- 동적 요소 확인 (모달, 토스트, 다이얼로그)
- 페이지 간 네비게이션 흐름 파악

#### 4.3 사용자 플로우 실험

주요 워크플로우 시뮬레이션:

```javascript
// 예: 로그인 플로우
browser_click: "로그인 버튼 셀렉터";
browser_type: ("이메일 입력란", "test@example.com");
browser_type: ("비밀번호 입력란", "password123");
browser_click: "제출 버튼";
browser_wait_for: "대시보드 로딩 완료";
browser_snapshot: "로그인 후 상태";
```

**탐색할 플로우**:

- 로그인/로그아웃 (있는 경우)
- CRUD 작업 (생성, 읽기, 수정, 삭제)
- 폼 제출 및 유효성 검사
- 모달/다이얼로그 상호작용
- 검색 및 필터링
- 페이지네이션
- 파일 업로드 (있는 경우)

각 단계마다 스냅샷 캡처하여 상태 변화 기록

#### 4.4 엣지 케이스 탐색

- 빈 상태 (empty state): 데이터가 없을 때 UI
- 로딩 상태: 네트워크 요청 중 상태
- 에러 상태: 유효성 검사 실패, API 에러
- 권한 없는 페이지 접근
- 잘못된 입력 처리
- 긴 텍스트, 특수 문자 입력

#### 4.5 반응형 및 접근성 확인 (간단히)

- 다양한 뷰포트 크기 (모바일, 태블릿, 데스크톱)
- 키보드 네비게이션 가능 여부
- 포커스 상태 확인

### 🐛 버그 발견 시 처리 지침

**중요**: Playwright MCP로 브라우저 탐색 중 버그를 발견하더라도:

❌ **하지 말 것**:

- 사용자에게 버그 보고하거나 피드백
- 버그 수정 제안
- 테스트 시나리오에서 버그 회피 전략 제안

✅ **해야 할 것**:

- 버그가 있는 기능도 **정상적으로 작동해야 하는 방식대로** 시나리오 작성
- "현재는 작동하지 않지만 작동해야 하는" 기능을 테스트 대상에 포함
- 버그는 UI E2E 테스트 **실행 단계**에서 자연스럽게 발견되고 수정됨

**이유**:

- 리서치 단계는 "무엇을 테스트할지" 정의하는 단계
- 실행 단계에서 버그 발견 및 수정 진행
- 버그가 있어도 테스트 시나리오는 완전해야 함 (TDD 사고방식)

### 5. 테스트 시나리오 정의

**코드 분석 + 브라우저 탐색 결과 통합**:

각 시나리오에는 출처 표시:

- 📊 코드 분석으로 발견
- 🎭 브라우저 탐색으로 발견
- 📊🎭 양쪽에서 발견

**우선순위 지정 (Critical/High/Medium)**:

**Critical**: 실패 시 앱이 작동하지 않는 핵심 기능

- 사용자 인증
- 메인 기능 워크플로우
- 데이터 무결성 작업

**High**: 자주 사용되는 중요 기능

- 보조 워크플로우
- 일반적인 사용자 상호작용
- UI 컴포넌트 동작

**Medium**: 있으면 좋은 기능

- 시각적 회귀
- 성능 체크
- 접근성 테스트

**각 시나리오 포함 사항**:

1. **명확한 설명**: 무엇을 테스트하는지
2. **출처**: 📊 코드 분석 | 🎭 브라우저 탐색
3. **테스트 단계**: 상세한 사용자 액션
4. **예상 결과**: 무엇이 일어나야 하는지
5. **검증 포인트**: MCP 도구로 확인할 사항
6. **우선순위 레벨**: Critical/High/Medium
7. **의존성**: 필요한 설정 또는 이전 테스트

### 6. 이중 언어 문서 완전 새로 생성

**생성할 파일**:

- `docs/e2e-ui/test-targets.ko.md` (한국어)
- `docs/e2e-ui/test-targets.md` (영어)

**문서 동기화**:

- 내용은 완전히 동일하되 언어만 다름
- 코드 예제, 기술 용어는 양쪽 동일
- 파일 상단에 언어 전환 링크

**중요 - 기존 문서 처리**:

- 기존 문서가 있다면 **완전히 삭제하고 새로 생성**
- 과거 내용은 참고하지 않음 (오직 테스트 파일 케이스만 참고)
- 항상 깨끗한 상태에서 시작

---

## 주요 규칙

### ✅ 반드시 해야 할 것

- **Playwright MCP로 실제 브라우저 탐색 필수** (코드 분석만으로 부족)
- **문서는 항상 완전히 새로 생성** (기존 문서 삭제)
- 기존 테스트 **파일의 케이스만** 읽어서 컨텍스트 파악
- 프레임워크 자동 감지 및 적절한 스킬 로드
- 이중 언어 문서 동시 생성 (ko.md, .md)
- 백엔드가 있으면 비즈니스 도메인 파악
- 중요한 사용자 플로우 우선순위 지정
- 정상 경로와 에러 케이스 모두 고려
- 페이지/기능별로 관련 시나리오 그룹화
- 각 테스트에 명확한 성공 기준 정의
- 각 시나리오에 출처 표시 (📊 코드 | 🎭 브라우저)

### ❌ 절대 하지 말아야 할 것

- **Playwright MCP 브라우저 탐색 건너뛰기**
- **기존 docs/e2e-ui/test-targets.md 문서 읽거나 참고** (오직 새로 생성만)
- **기존 문서 내용을 보존하거나 병합** (완전 삭제 후 재생성)
- 버그 발견 시 사용자에게 피드백 (실행 단계에서 처리)
- React/TypeScript 스킬만 하드코딩 (프레임워크 자동 감지 필요)
- 단일 언어 문서만 생성
- 엣지 케이스 및 에러 상태 무시
- 모호하거나 테스트 불가능한 시나리오 정의

### 🎯 테스트 시나리오 품질

각 시나리오는 다음을 포함해야 합니다:

1. **명확한 설명**: 무엇을 테스트하는지
2. **출처**: 📊 코드 분석 | 🎭 브라우저 탐색
3. **테스트 단계**: 상세한 사용자 액션
4. **예상 결과**: 무엇이 일어나야 하는지
5. **검증 포인트**: MCP 도구로 확인할 사항
6. **우선순위 레벨**: Critical/High/Medium
7. **의존성**: 필요한 설정 또는 이전 테스트

---

## 문서 템플릿

### 한국어 버전: `docs/e2e-ui/test-targets.ko.md`

```markdown
# UI E2E 테스트 대상

[**한국어**](./test-targets.ko.md) | [English](./test-targets.md)

> **생성일**: {YYYY-MM-DD HH:mm}
> **리서치 방법**: 코드 분석 + Playwright 브라우저 탐색

---

---

## 📊 현재 커버리지 분석

### 기존 UI E2E 테스트

- `{test-file-1}`: {커버하는 내용}
- `{test-file-2}`: {커버하는 내용}

### 코드베이스 분석

- **프레임워크**: {React/Next.js/Vue/etc}
- **주요 라우트**: {X개}
- **컴포넌트**: {Y개}

### 🎭 Playwright 브라우저 탐색 결과

- **탐색한 페이지**: {Z개}
- **발견한 사용자 플로우**: {W개}
- **상호작용 요소**: {V개}
- **테스트 가능한 엣지 케이스**: {U개}

### 커버리지 갭

- {갭 1}
- {갭 2}

---

## 🎯 우선순위별 테스트 시나리오

### Critical 우선순위

#### 테스트 1: {시나리오 이름}

**출처**: 📊 코드 분석 | 🎭 브라우저 탐색

**페이지/기능**: {페이지 이름 또는 기능 영역}

**설명**: {이 테스트가 검증하는 내용}

**테스트 단계**:

1. {단계 1}
2. {단계 2}
3. {단계 3}

**예상 결과**:

- {예상 결과 1}
- {예상 결과 2}

**검증 포인트** (Playwright MCP):

- `browser_snapshot`: {확인할 DOM 요소}
- `browser_take_screenshot`: {스크린샷으로 확인할 사항}

**우선순위**: Critical

**의존성**: {없음 / 이전 테스트 N}

---

#### 테스트 2: {시나리오 이름}

{동일한 구조}

---

### High 우선순위

#### 테스트 3: {시나리오 이름}

{동일한 구조}

---

### Medium 우선순위

#### 테스트 4: {시나리오 이름}

{동일한 구조}

---

## 📋 테스트 구현 순서

권장 실행 순서 (의존성 고려):

1. 테스트 N: {이름} (Critical - 의존성 없음)
2. 테스트 M: {이름} (Critical - 테스트 N에 의존)
3. 테스트 K: {이름} (High - 의존성 없음)
   ...

---

## 🔧 기술적 고려사항

### Playwright MCP 도구

- **네비게이션**: `browser_navigate`
- **상호작용**: `browser_click`, `browser_type`, `browser_select_option`
- **검증**: `browser_snapshot`, `browser_take_screenshot`
- **대기**: `browser_wait_for`

### 테스트 환경

- **Base URL**: http://localhost:{port}
- **필요한 서비스**: {백엔드, 데이터베이스 등}

### 테스트 데이터

- {필요한 테스트 계정 (역할별)}
- {필요한 샘플 데이터}
- {외부 서비스 모킹 요구사항}

---

## 🚨 주의사항

- {알려진 버그나 불안정한 동작}
- {환경별 고려사항}
- {성능 관련 주의사항}
```

### 영어 버전: `docs/e2e-ui/test-targets.md`

한국어 버전과 동일한 구조, 내용은 영어로 번역.

파일 상단 언어 링크:

```markdown
[한국어](./test-targets.ko.md) | [**English**](./test-targets.md)
```

---

## 완료 보고

리서치 완료 후 사용자에게 요약 제공:

```markdown
## UI E2E 테스트 리서치 완료

### 📊 발견 사항

- **프레임워크**: {React/Next.js/Vue/etc}
- **탐색한 페이지**: {X개}
- **발견한 사용자 플로우**: {Y개}
- **기존 UI E2E 테스트**: {Z개}

### 🎯 테스트 시나리오

- **Critical**: {N개}
- **High**: {M개}
- **Medium**: {K개}
- **총합**: {N+M+K개}

### 📝 생성된 문서

- `docs/e2e-ui/test-targets.ko.md` (한국어)
- `docs/e2e-ui/test-targets.md` (영어)

### 🔍 커버리지 갭

- {주요 갭 1}
- {주요 갭 2}

### 다음 단계

`/e2e-ui:execute` 커맨드로 테스트 시나리오를 실제 Playwright 테스트로 구현할 수 있습니다.
```

---

## 실행

위 가이드라인에 따라 작업을 시작하세요.
